UserAccount:
  meta:
    sensitive:
      - passwordHash
      - permissions
      - otpSecret
    topLevel: true
  properties:
    userAccountId: integer primary auto(1,1)
    firstName: string(30)
    lastName: string(30)
    emailAddress: string unique
    emailVerified: boolean default(false)
    lastActive: datetime default(NOW)
    lastPasswordChange: datetime
    passwordHash: string
    phoneNumber: string
    profileImageUrl: string
    permissions: integer default(0)
    otpSecret: string?
    otpEnabled: boolean default(false)
    isActive: boolean default(true)
    createdBy: integer?
    createdAt: datetime default(NOW)
    modifiedBy: integer?
    modifiedAt: datetime default(NOW)
  operations:
    # Login User #
    login:
      returns: LoginResponse
      arguments:
        emailAddress: string
        password: string
        otpToken: string?
        sessionId: string
        client_id: string
        response_type: string
        redirect_uri: string
        state: string?
    # Create User Account #
    registerUser:
      returns: string
      arguments:
        password: string
        confirm: string
        cpt: string
        firstName:
        lastName:
        otpSecret:
    # Register for Multifactor #
    generateMfaKey:
      returns: string
      arguments:
        emailAddress:
    # Verify Multifactor Auth key #
    verifyMfaKey:
      returns: boolean
      arguments:
        secret: string
        token: string
    # Reset Password #
    sendBackupCode:
      returns: boolean
      arguments:
        emailAddress: string
    resetPassword:
      returns: boolean
      arguments:
        emailAddress:
    # Validate a Password #
    validatePassword:
      returns: boolean
      arguments:
        password: string
        confirm: string
    # Change Password #
    changePassword:
      returns: boolean
      arguments:
        password: string
        confirm: string
        cpt: string

