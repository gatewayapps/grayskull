UserAccount:
  meta:
    sensitive:
      - passwordHash
      - otpSecret
    database: true
    graphql: true
    graphqlResolvers: true
  properties:
    userAccountId: uniqueidentifier primary default('new_uuid')
    firstName: string(30)
    lastName: string(30)
    lastActive: datetime default(NOW)
    lastPasswordChange: datetime
    passwordHash: string
    phoneNumber: string
    profileImageUrl: string
    permissions: integer default(0)
    otpSecret: string?
    otpEnabled: boolean default(false)
    isActive: boolean default(true)
    createdBy: uniqueidentifier?
    createdAt: datetime default(NOW)
    updatedBy: uniqueidentifier?
    updatedAt: datetime default(NOW)
    deletedBy: uniqueidentifier?
    deletedAt: datetime?
  references:
    emailAddresses: multiple of EmailAddress
  operations:
    # Login User #
    login:
      returns: LoginResponse
      arguments:
        emailAddress: string
        password: string
        otpToken: string?
        sessionId: string
        client_id: string
        response_type: string
        redirect_uri: string
        state: string?
    # Create User Account #
    registerUser:
      returns: RegisterUserResponse
      arguments:
        emailAddress: string
        password: string
        confirm: string
        firstName:
        lastName:
        otpSecret:
        client_id: string?
    # Register for Multifactor #
    generateMfaKey:
      returns: string
      arguments:
        emailAddress: string
    # Verify Multifactor Auth key #
    verifyMfaKey:
      returns: boolean
      arguments:
        secret: string
        token: string
    # Reset Password #
    sendBackupCode:
      returns: boolean
      arguments:
        emailAddress: string
    resetPassword:
      returns: boolean
      arguments:
        emailAddress: string
    # Validate a Password #
    validatePassword:
      returns: boolean
      arguments:
        password: string
        confirm: string
    # Change Password #
    changePassword:
      returns: boolean
      arguments:
        password: string
        confirm: string
        cpt: string

